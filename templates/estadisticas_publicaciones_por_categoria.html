{% extends 'index.html' %}
{% load static %}

{% block content %}
<div class="w-screen h-screen flex bg-gray-50">
    <div class="w-auto">{% include 'navbar.html' %}</div> {# CAMBIADO #}
    <div class="flex-1 flex flex-col overflow-hidden">
        <header class="bg-white border-b border-gray-200 px-6 py-4 shadow-sm">
            <div class="flex items-center justify-between">
                <h1 class="text-2xl font-bold text-gray-900">ðŸ“Š Reportes y EstadÃ­sticas uwu</h1>
            </div>
        </header>

        <main class="flex-1 overflow-y-auto p-6">
            <div class="max-w-4xl mx-auto bg-white rounded-xl shadow-lg p-6 mb-8 border border-gray-100">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">{{ titulo_grafico }}</h2>
                <div class="relative h-96"> 
                    <canvas id="publicacionesPorCategoriaChart"></canvas>
                </div>
            </div>

            <div class="max-w-4xl mx-auto bg-white rounded-xl shadow-lg p-6 mb-8 border border-gray-100">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">Detalle de Publicaciones por CategorÃ­a</h2>
                <ul class="list-disc pl-5 text-gray-700">
                    {% for label in labels %}
                        <li>{{ label }}: {{ data.forloop.counter0 }} publicaciones</li>
                    {% empty %}
                        <li>No hay datos de publicaciones para mostrar.</li>
                    {% endfor %}
                </ul>
            </div>

        </main>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const ctx = document.getElementById('publicacionesPorCategoriaChart').getContext('2d');

        
        const labels = {{ labels|safe }};
        const data = {{ data|safe }};
        const backgroundColors = {{ background_colors|safe }};

        // Creacion del primer grafico
        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: 'NÃºmero de Publicaciones', 
                    data: data,
                    backgroundColor: backgroundColors,
                    // Borde un poco mÃ¡s oscuro para cada barra
                    borderColor: backgroundColors.map(color => color.replace('0.7', '1')),
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false, 
                scales: {
                    y: {
                        beginAtZero: true, 
                        ticks: {
                            precision: 0 
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: true, 
                        position: 'top', 
                    },
                    title: {
                        display: true,
                        text: '{{ titulo_grafico|safe }}'
                    }
                }
            }
        });
    });
</script>
{% endblock %}