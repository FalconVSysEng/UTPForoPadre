{% load static %}
{% url 'cerrar_sesion' as cerrarsesion %}
{% url 'home' as home %}
{% url 'mispublicaciones' as mispublicaciones %}
{% url 'configuracionusuario' as configuracionusuario %}
{% url 'lista_usuarios' as gestionusuarios %}
{% url 'lista_categorias' as lista_categorias %}

<div class="overflow-hidden">
  <div class="flex h-screen">
    
    <!-- Sidebar -->
    <div
      id="sidebar"
      class="bg-gradient-to-b from-slate-900 via-slate-800 to-slate-900 w-72 transition-transform transform md:translate-x-0 -translate-x-full fixed md:relative z-30 h-full shadow-2xl border-r border-slate-700"
    >
      
      <!-- Header del Sidebar -->
      <div class="relative p-6 border-b border-slate-700/50">
        <!-- Elemento decorativo de fondo -->
        <div class="absolute top-0 left-0 w-full h-full bg-gradient-to-r from-blue-600/10 to-purple-600/10"></div>
        
        <div class="relative z-10 text-center space-y-4">
          <!-- Avatar con efectos -->
          <div class="relative inline-block">
            <div class="absolute -inset-1 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full blur opacity-75 animate-pulse"></div>
            <img
              src="{% static 'img/logouser.png' %}"
              alt="Avatar de usuario"
              class="relative w-20 h-20 rounded-full border-4 border-white shadow-xl object-cover"
            />
            <!-- Indicador de estado online -->
            <div class="absolute bottom-1 right-1 w-4 h-4 bg-green-500 border-2 border-white rounded-full"></div>
          </div>
          
          <!-- Saludo personalizado -->
          <div class="space-y-1">
            <h2 class="text-lg font-bold text-white">
              ¡Hola, {{ user.first_name }}! 👋
            </h2>
            <p class="text-sm text-slate-300">
              {{ user.last_name }}
            </p>
            {% if user.is_staff %}
              <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-amber-100 text-amber-800 border border-amber-200">
                ⭐ Administrador
              </span>
            {% else %}
              <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800 border border-blue-200">
                👤 Alumno
              </span>
            {% endif %}
          </div>
        </div>
      </div>

      <!-- Navegación Principal -->
      <nav class="flex-1 p-4 space-y-2 overflow-y-auto">
        
        <!-- Sección: Navegación Principal -->
        <div class="space-y-1">
          <h3 class="px-3 text-xs font-semibold text-slate-400 uppercase tracking-wider mb-3">
            📍 Navegación
          </h3>
          
          <a
            href="{{ home }}"
            class="group flex items-center px-3 py-3 text-sm font-medium text-slate-300 rounded-xl hover:bg-slate-700/50 hover:text-white transition-all duration-200 relative overflow-hidden"
          >
            <div class="absolute inset-0 bg-gradient-to-r from-blue-600/0 to-blue-600/0 group-hover:from-blue-600/10 group-hover:to-purple-600/10 transition-all duration-200"></div>
            <span class="relative flex items-center gap-3">
              <span class="text-lg">🏠</span>
              <span>Inicio</span>
            </span>
            
          </a>

          <a
            href="{{ mispublicaciones }}"
            class="group flex items-center px-3 py-3 text-sm font-medium text-slate-300 rounded-xl hover:bg-slate-700/50 hover:text-white transition-all duration-200 relative overflow-hidden"
          >
            <div class="absolute inset-0 bg-gradient-to-r from-blue-600/0 to-blue-600/0 group-hover:from-blue-600/10 group-hover:to-purple-600/10 transition-all duration-200"></div>
            <span class="relative flex items-center gap-3">
              <span class="text-lg">💬</span>
              <span>Mis Publicaciones</span>
            </span>
            <!-- Badge de notificación -->
            <span class="ml-auto bg-blue-500 text-white text-xs rounded-full px-2 py-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200">3</span>
          </a>

          <a
            href="{{ configuracionusuario }}"
            class="group flex items-center px-3 py-3 text-sm font-medium text-slate-300 rounded-xl hover:bg-slate-700/50 hover:text-white transition-all duration-200 relative overflow-hidden"
          >
            <div class="absolute inset-0 bg-gradient-to-r from-blue-600/0 to-blue-600/0 group-hover:from-blue-600/10 group-hover:to-purple-600/10 transition-all duration-200"></div>
            <span class="relative flex items-center gap-3">
              <span class="text-lg">⚙️</span>
              <span>Configuración</span>
            </span>
            
          </a>
        </div>

        <!-- Sección: Administración (solo para staff) -->
        {% if user.is_staff %}
        <div class="pt-6 space-y-1">
          <h3 class="px-3 text-xs font-semibold text-slate-400 uppercase tracking-wider mb-3 flex items-center gap-2">
            <span>🛡️</span>
            <span>Administración</span>
          </h3>
          
          <a
            href="{{ gestionusuarios }}"
            class="group flex items-center px-3 py-3 text-sm font-medium text-slate-300 rounded-xl hover:bg-slate-700/50 hover:text-white transition-all duration-200 relative overflow-hidden"
          >
            <div class="absolute inset-0 bg-gradient-to-r from-amber-600/0 to-amber-600/0 group-hover:from-amber-600/10 group-hover:to-orange-600/10 transition-all duration-200"></div>
            <span class="relative flex items-center gap-3">
              <span class="text-lg">👥</span>
              <span>Gestión de Usuarios</span>
            </span>
          </a>

          <a
            href="{{ lista_categorias }}"
            class="group flex items-center px-3 py-3 text-sm font-medium text-slate-300 rounded-xl hover:bg-slate-700/50 hover:text-white transition-all duration-200 relative overflow-hidden"
          >
            <div class="absolute inset-0 bg-gradient-to-r from-amber-600/0 to-amber-600/0 group-hover:from-amber-600/10 group-hover:to-orange-600/10 transition-all duration-200"></div>
            <span class="relative flex items-center gap-3">
              <span class="text-lg">📂</span>
              <span>Gestión de Categorías</span>
            </span>
            
          </a>

          <a
            href="#"
            class="group flex items-center px-3 py-3 text-sm font-medium text-slate-300 rounded-xl hover:bg-slate-700/50 hover:text-white transition-all duration-200 relative overflow-hidden"
          >
            <div class="absolute inset-0 bg-gradient-to-r from-amber-600/0 to-amber-600/0 group-hover:from-amber-600/10 group-hover:to-orange-600/10 transition-all duration-200"></div>
            <span class="relative flex items-center gap-3">
              <span class="text-lg">📊</span>
              <span>Reportes y Estadísticas</span>
            </span>
            <span class="ml-auto bg-amber-500 text-white text-xs rounded-full px-2 py-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200">Nuevo</span>
          </a>
        </div>
        {% endif %}

        <!-- Sección: Información del Sistema -->
        
      </nav>

      <!-- Footer del Sidebar -->
      <div class="p-4 border-t border-slate-700/50">
        <!-- Botón de cerrar sesión mejorado -->
        <a
          href="{{ cerrarsesion }}"
          class="group flex items-center justify-center gap-3 w-full px-4 py-3 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white font-semibold rounded-xl transition-all duration-200 transform hover:scale-105 hover:shadow-lg relative overflow-hidden"
        >
          <div class="absolute inset-0 bg-gradient-to-r from-white/0 to-white/0 group-hover:from-white/10 group-hover:to-white/5 transition-all duration-200"></div>
          <span class="relative flex items-center gap-2">
            <span class="text-lg">🚪</span>
            <span>Cerrar Sesión</span>
          </span>
        </a>
        
        <!-- Información adicional -->
        <div class="mt-3 text-center">
          <p class="text-xs text-slate-500">
            © 2024 UTPForo
          </p>
          <p class="text-xs text-slate-600 mt-1">
            Versión 2.1.0
          </p>
        </div>
      </div>
    </div>

    <!-- Overlay para móviles -->
    <div class="fixed inset-0 bg-black bg-opacity-50 z-20 md:hidden hidden" id="sidebar-overlay"></div>
    
    <!-- Botón para abrir sidebar en móviles -->
    <button
      id="sidebar-toggle"
      class="fixed top-4 left-4 z-40 md:hidden bg-slate-800 text-white p-2 rounded-lg shadow-lg hover:bg-slate-700 transition-colors"
    >
      <span class="text-xl">☰</span>
    </button>
  </div>
</div>

<!-- Script para funcionalidad móvil -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  const sidebar = document.getElementById('sidebar');
  const overlay = document.getElementById('sidebar-overlay');
  const toggle = document.getElementById('sidebar-toggle');
  
  toggle.addEventListener('click', function() {
    sidebar.classList.toggle('-translate-x-full');
    overlay.classList.toggle('hidden');
  });
  
  overlay.addEventListener('click', function() {
    sidebar.classList.add('-translate-x-full');
    overlay.classList.add('hidden');
  });
});
</script>